function Geography(country_ajax_url,province_ajax_url,options){var self=this;options=options||{};this.country_ajax_url=country_ajax_url;this.province_ajax_url=province_ajax_url;this.country_input_id=options.country_input_id||'#id_country';this.province_control=options.province_control||"#row_province, #row_state";this.province_input_id=options.province_input_id||'#id_province, #id_state';this.$country=$(this.country_input_id);this.$province_control=$(this.province_control);this.$province_control.hide();this.load_provinces=function(country_id){$.getJSON(self.province_ajax_url,{'country':country_id},function(data,textStatus,jqXHR){var $province=$(self.province_input_id);if(data.length>0){self.$province_control.show();}else{self.$province_control.hide();}
var selected=$province.val();$province.html('');$province.append(new Option('------',''));$(data).each(function(index,obj){$province.append(new Option(obj.fields.name,obj.pk));});$province.val(selected);});};this.load_countries=function(){$.getJSON(this.country_ajax_url,{},function(data,textStatus,jqXHR){self.$country.html('');self.$country.append(new Option('------',''));$(data).each(function(index,obj){self.$country.append(new Option(obj.fields.name,obj.pk));});});};var c_id=this.$country.val();self.load_provinces(c_id);this.$country.change(function(event){var c_id=self.$country.val();self.load_provinces(c_id);});};$(document).ready(function(){var geography=new Geography('/geography/countries','/geography/states',{province_control:"#div_id_state_province",province_input_id:'#id_state_province'});$('#row_visited_when').hide();function show_visited_when(){var visited_previously=$('#id_visited_previously').val();if(visited_previously==="True"){$('#row_visited_when').show();}
else{$('#id_visited_when_month').val('');$('#id_visited_when_day').val('');$('#id_visited_when_year').val('');}}
show_visited_when();$('#id_visited_previously').change(function(e){$('#row_visited_when').hide();show_visited_when();});});;function connect(field,connections){field.on("change",function(){process_connect(connections,$(this).val());});process_connect(connections,field.val());}
function process_connect(fields,value){fields.forEach(field=>{if(value===true||field.visibleWhen.includes(value)){field.field.show();field.field.addClass('yellow-higlight')}else{field.field.hide();field.field.removeClass('yellow-higlight')}});}
$(document).ready(function(){var country=$('#visa-country').attr('data-country')
if(country.toLowerCase()==='iran'){var visa_country_ids=['American','Canadian','British']}else{var visa_country_ids=true}
connect($('#id_nationality'),[{field:$('#div_id_children_name_and_dob'),visibleWhen:visa_country_ids},{field:$('#div_id_history_of_migration'),visibleWhen:visa_country_ids},{field:$('#div_id_travel_experience'),visibleWhen:visa_country_ids},{field:$('#div_id_interests_and_activities'),visibleWhen:visa_country_ids},{field:$('#div_id_education'),visibleWhen:visa_country_ids},{field:$('#div_id_has_former_nationality'),visibleWhen:visa_country_ids},{field:$('#div_id_additional_post_secondary_education'),visibleWhen:visa_country_ids},{field:$('#div_id_social_media_accounts'),visibleWhen:visa_country_ids}])
connect($('#id_marital_status'),[{field:$('#div_id_spouse_name'),visibleWhen:['Married','Separated']},{field:$('#div_id_divorce_date'),visibleWhen:['Divorced']},{field:$('#div_id_ex_spouse_name'),visibleWhen:['Divorced','Widowed']},{field:$('#div_id_wedding_date'),visibleWhen:['Married']}])
connect($('#id_visited_previously'),[{field:$('#div_id_visited_when'),visibleWhen:['True']},{field:$('#div_id_visited_when_departure'),visibleWhen:['True']}])
connect($('#id_employed'),[{field:$('#div_id_occupation'),visibleWhen:['Employed']},{field:$('#div_id_employer'),visibleWhen:['Employed']},{field:$('#div_id_employer_period_start'),visibleWhen:['Employed']},{field:$('#div_id_employer_period_end'),visibleWhen:['Retired']},{field:$('#div_id_position'),visibleWhen:['Employed']},{field:$('#div_id_retiring_date'),visibleWhen:['Retired']}])
connect($('#id_has_former_nationality'),[{field:$('#div_id_former_nationality'),visibleWhen:['True']}])
connect($('#id_education'),[{field:$('#div_id_degree'),visibleWhen:['True']},{field:$('#div_id_field_of_study'),visibleWhen:['True']},{field:$('#div_id_graduation_date'),visibleWhen:['True']},{field:$('#div_id_place_of_education'),visibleWhen:['True']}])
$('#id_nationality').change(function(){if(!visa_country_ids.includes($(this).val())){$('#id_has_former_nationality').val("False").trigger("change")
$('#id_education').val('False').trigger("change");}})});